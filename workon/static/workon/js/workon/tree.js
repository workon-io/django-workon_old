/* jQuery Tree Multiselect v2.0.2 | (c) Patrick Tsai | MIT Licensed */
!function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b,c){"use strict";function d(a){var b={allowBatchSelection:!0,collapsible:!0,enableSelectAll:!1,selectAllText:"Select All",unselectAllText:"Unselect All",freeze:!1,hideSidePanel:!1,onChange:null,onlyBatchSelection:!1,sectionDelimiter:"/",showSectionOnSelected:!0,sortable:!1,startCollapsed:!1};return $.extend({},b,a)}var e=(a("./option"),a("./tree")),f=(a("./ui-builder"),a("./utility"),0),g=function(a){var b=this,c=d(a);return this.each(function(){var a=$(b);a.attr("multiple","").css("display","none");var d=new e(f,a,c);d.initialize(),++f}),this};b.exports=g},{"./option":2,"./tree":4,"./ui-builder":5,"./utility":6}],2:[function(a,b,c){"use strict";b.exports=function(a,b,c,d,e,f){this.id=a,this.value=b,this.text=c,this.description=d,this.initialIndex=e,this.section=f}},{}],3:[function(a,b,c){"use strict";!function(b){b.fn.treeMultiselect=a("./main")}(jQuery)},{"./main":1}],4:[function(a,b,c){"use strict";function d(a,b,c){this.id=a,this.$originalSelect=b;var d=new f(b,c.hideSidePanel);this.$selectionContainer=d.$selectionContainer,this.$selectedContainer=d.$selectedContainer,this.options=c,this.selectOptions=[],this.selectedKeys=[],this.keysToAdd=[],this.keysToRemove=[]}var e=a("./option"),f=a("./ui-builder"),g=a("./utility");d.prototype.initialize=function(){var a=this.generateSelections(),b=this.generateHtmlFromData(a);this.$selectionContainer.append(b),this.popupDescriptionHover(),this.options.allowBatchSelection&&this.handleSectionCheckboxMarkings(),this.options.collapsible&&this.addCollapsibility(),this.options.enableSelectAll&&this.createSelectAllButtons(),this.armRemoveSelectedOnClick(),this.updateSelectedAndOnChange(),this.render(!0)},d.prototype.generateSelections=function(){var a=[[],{}],b=this.options.sectionDelimiter,c=this,d=0,f=[];return this.$originalSelect.find("> option").each(function(){var g=this;g.setAttribute("data-key",d);var h=g.getAttribute("data-section"),i=h&&h.length>0?h.split(b):[],j=g.value,k=g.text,l=g.getAttribute("data-description"),m=parseInt(g.getAttribute("data-index")),n=new e(d,j,k,l,m,h);m?c.keysToAdd[m]=d:g.hasAttribute("selected")&&f.push(d),c.selectOptions[d]=n;for(var o=a,p=0;p<i.length;++p)o[1][i[p]]||(o[1][i[p]]=[[],{}]),o=o[1][i[p]];o[0].push(n),++d}),this.keysToAdd=g.arrayUniq(g.arrayRemoveFalseyExceptZero(this.keysToAdd).concat(f)),a},d.prototype.generateHtmlFromData=function(a){for(var b="",c=0;c<a[0].length;++c){var d=a[0][c],e="treemultiselect-"+this.id+"-"+d.id,f=d.description?" data-description='"+d.description+"'":"",g=d.initialIndex?" data-index='"+d.initialIndex+"'":"",h="",i="";this.options.onlyBatchSelection?i+=""+(d.text||d.value):(h+="<input class='option' type='checkbox' id='"+e+"'",this.options.freeze&&(h+=" disabled"),h+="/>",i+="<label for='"+e+"'>"+(d.text||d.value)+"</label>");var j=d.description?"<span class='description'>?</span>":"";b+="<div class='item' data-key='"+d.id+"'data-value='"+d.value+"'"+f+g+">"+h+j+i+"</div>"}for(var k=Object.keys(a[1]),l=0;l<k.length;++l){var m="";(this.options.onlyBatchSelection||this.options.allowBatchSelection)&&(m+="<input class='section' type='checkbox'",this.options.freeze&&(m+=" disabled"),m+="/>");var n=this.generateHtmlFromData(a[1][k[l]]);b+="<div class='section'><div class='title'>"+m+k[l]+"</div>"+n+"</div>"}return b},d.prototype.popupDescriptionHover=function(){this.$selectionContainer.on("mouseenter","div.item > span.description",function(){var a=$(this).parent(),b=a.attr("data-description"),c=document.createElement("div");c.className="temp-description-popup",c.innerHTML=b,c.style.position="absolute",a.append(c)}),this.$selectionContainer.on("mouseleave","div.item > span.description",function(){var a=$(this).parent();a.find("div.temp-description-popup").remove()})},d.prototype.handleSectionCheckboxMarkings=function(){var a=this;this.$selectionContainer.on("change","input.section[type=checkbox]",function(){var b=$(this).closest("div.section"),c=b.find("div.item"),d=[];c.each(function(a,b){d.push(g.getKey(b))}),this.checked?a.keysToAdd=g.arrayUniq(a.keysToAdd.concat(d)):a.keysToRemove=g.arrayUniq(a.keysToRemove.concat(d)),a.render()})},d.prototype.redrawSectionCheckboxes=function(a){a=a||this.$selectionContainer;var b=[!0,!0],c=a.find("> div.item > input[type=checkbox]");c.each(function(){this.checked?b[1]=!1:b[0]=!1});var d=this,e=a.find("> div.section");e.each(function(){var a=d.redrawSectionCheckboxes($(this));b[0]=b[0]&&a[0],b[1]=b[1]&&a[1]});var f=a.find("> div.title > input[type=checkbox]");return f.length&&(f=f[0],b[0]?(f.checked=!0,f.indeterminate=!1):b[1]?(f.checked=!1,f.indeterminate=!1):(f.checked=!1,f.indeterminate=!0)),b},d.prototype.addCollapsibility=function(){var a="-",b="+",c="div.title",d=this.$selectionContainer.find(c),e=document.createElement("span");e.className="collapse-section",this.options.startCollapsed?($(e).text(b),d.siblings().toggle()):$(e).text(a),d.prepend(e),this.$selectionContainer.on("click",c,function(c){if("INPUT"!=c.target.nodeName){var d=$(this).find("> span.collapse-section"),e=d.text();d.text(e==a?b:a);var f=d.parent();f.siblings().toggle()}})},d.prototype.createSelectAllButtons=function(){var a=$("<span class='select-all'></span>");a.text(this.options.selectAllText);var b=$("<span class='unselect-all'></span>");b.text(this.options.unselectAllText);var c=$("<div class='select-all-container'></div>");c.prepend(b),c.prepend(a),this.$selectionContainer.prepend(c);var d=this;this.$selectionContainer.on("click","span.select-all",function(){for(var a=0;a<d.selectOptions.length;++a)d.keysToAdd.push(a);d.keysToAdd=g.arrayUniq(d.keysToAdd),d.render()}),this.$selectionContainer.on("click","span.unselect-all",function(){d.keysToRemove=g.arrayUniq(d.keysToRemove.concat(d.selectedKeys)),d.render()})},d.prototype.armRemoveSelectedOnClick=function(){var a=this;this.$selectedContainer.on("click","span.remove-selected",function(){var b=this.parentNode,c=g.getKey(b);a.keysToRemove.push(c),a.render()})},d.prototype.updateSelectedAndOnChange=function(){var a=this;if(this.$selectionContainer.on("change","input.option[type=checkbox]",function(b){var c=this,d=c.parentNode,e=g.getKey(d);g.assert(e||0===e),c.checked?a.keysToAdd.push(e):a.keysToRemove.push(e),a.render()}),this.options.sortable&&!this.options.freeze){var b=null,c=null;this.$selectedContainer.sortable({start:function(a,c){b=c.item.index()},stop:function(d,e){c=e.item.index(),b!==c&&(g.arrayMoveEl(a.selectedKeys,b,c),a.render())}})}},d.prototype.render=function(a){var b=this;this.keysToAdd=g.arraySubtract(this.keysToAdd,this.selectedKeys),this.keysToRemove=g.arrayIntersect(this.keysToRemove,this.selectedKeys);var c=this,d=this.$selectionContainer.find("div.item");this.$selectedContainer.find("div.item").filter(function(){var a=g.getKey(this);return c.keysToRemove.indexOf(a)!==-1}).remove(),d.filter(function(){var a=g.getKey(this);return c.keysToRemove.indexOf(a)!==-1}).find("> input[type=checkbox]").prop("checked",!1),this.selectedKeys=g.arraySubtract(this.selectedKeys,this.keysToRemove);for(var e="",f=0;f<this.keysToAdd.length;++f){var h=this.keysToAdd[f],i=this.selectOptions[h];this.selectedKeys.push(h);var j=this.options.freeze?"":"<span class='remove-selected'>Ã—</span>",k=this.options.showSectionOnSelected?"<span class='section-name'>"+i.section+"</span>":"";e+="<div class='item' data-key='"+i.id+"' data-value='"+i.value+"'>"+j+k+i.text+"</div>"}this.$selectedContainer.append(e),d.filter(function(){var a=g.getKey(this);return c.keysToAdd.indexOf(a)!==-1}).find("> input[type=checkbox]").prop("checked",!0),this.selectedKeys=g.arrayUniq(this.selectedKeys.concat(this.keysToAdd)),this.redrawSectionCheckboxes();for(var l={},m={},n=0;n<this.selectedKeys.length;++n){var o=this.selectOptions[this.selectedKeys[n]].value;l[this.selectedKeys[n]]=!0,m[o]=n}var p=this.$originalSelect.find("option").toArray();if(p.sort(function(a,b){var c=m[a.value]||0,d=m[b.value]||0;return c-d}),this.$originalSelect.html(p),this.$originalSelect.find("option").each(function(a,b){l[g.getKey(b)]?this.selected=!0:this.selected=!1}),this.$originalSelect.change(),!a&&this.options.onChange){var q=this.selectedKeys.map(function(a){return b.selectOptions[a]}),r=this.keysToAdd.map(function(a){return b.selectOptions[a]}),s=this.keysToRemove.map(function(a){return b.selectOptions[a]});this.options.onChange(q,r,s)}this.keysToRemove=[],this.keysToAdd=[]},b.exports=d},{"./option":2,"./ui-builder":5,"./utility":6}],5:[function(a,b,c){"use strict";b.exports=function(a,b){var c=$("<div class='tree-multiselect'></div>"),d=$("<div class='selections'></div>");b&&d.addClass("no-border"),c.append(d);var e=$("<div class='selected'></div>");b||c.append(e),a.after(c),this.$tree=c,this.$selectionContainer=d,this.$selectedContainer=e}},{}],6:[function(a,b,c){"use strict";b.exports={assert:function(a,b){if(!a)throw new Error(b||"Assertion failed")},getKey:function(a){return this.assert(a),parseInt(a.getAttribute("data-key"))},arraySubtract:function(a,b){for(var c={},d=[],e=0;e<b.length;++e)c[b[e]]=!0;for(var f=0;f<a.length;++f)c[a[f]]||d.push(a[f]);return d},arrayUniq:function(a){for(var b={},c=[],d=0;d<a.length;++d)b[a[d]]||(b[a[d]]=!0,c.push(a[d]));return c},arrayRemoveFalseyExceptZero:function(a){for(var b=[],c=0;c<a.length;++c)(a[c]||0===a[c])&&b.push(a[c]);return b},arrayMoveEl:function(a,b,c){var d=a[b];a.splice(b,1),a.splice(c,0,d)},arrayIntersect:function(a,b){for(var c=[],d={},e=0;e<b.length;++e)d[b[e]]=!0;for(var f=0;f<a.length;++f)d[a[f]]&&c.push(a[f]);return c}}},{}]},{},[3]);